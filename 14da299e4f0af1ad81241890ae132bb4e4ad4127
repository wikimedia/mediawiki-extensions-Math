{
  "comments": [
    {
      "key": {
        "uuid": "8e23439c_fbcf0e59",
        "filename": "db/mathlatexml.mysql.sql",
        "patchSetId": 18
      },
      "lineNbr": 25,
      "author": {
        "id": 915
      },
      "writtenOn": "2014-05-07T03:28:56Z",
      "side": 1,
      "message": "Is math_timestamp metadata or data? If it\u0027s data, then it should be explicitly set and not rely on automatic mechanisms.\n\nConsider using DATETIME instead. TIMESTAMP does time zone conversion which could be a trap for downstream users of the extension. It also has potential performance issues at scale [1].\n\nWhat is the policy for time stamp field types in the Math extension, if any? Consider that MW core uses VARBINARY, which, though not very elegant, is at least consistent across most tables.\n\n[1] https://www.facebook.com/MySQLatFacebook/posts/10152018528871696:0",
      "revId": "14da299e4f0af1ad81241890ae132bb4e4ad4127",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8e23439c_fbaeee29",
        "filename": "db/mathlatexml.mysql.sql",
        "patchSetId": 18
      },
      "lineNbr": 25,
      "author": {
        "id": 183
      },
      "writtenOn": "2014-05-07T06:38:20Z",
      "side": 1,
      "message": "It\u0027s metadata. I used this field for debugging purposes. It turned out to be quite helpful to track down errors and to delete wrong entries from the database cache.\nThe alternative which I used before was to add this as seperate field that gets added to the table only if $wgMathDebug is set to true. However, there are two issues with this approach:\n1) If $wgMathDebug is set to true without running update.php runtime errors will happen. This might lead to several bugzilla tickets et al.\n2) If there is already data in the table it might take a long time to alter the schema. Especially given that MySQL uses row oriented storage.\n\nI read the mysql manual again [2]. As far as I understand timestamps are stored in UTC always. In the facebook post they say \"MySQL is configured to use system time zone\" is that the default? At leas I could reproduce this with a first experiment.\n\n\n[2] http://dev.mysql.com/doc/refman/5.7/en/timestamp-initialization.html",
      "parentUuid": "8e23439c_fbcf0e59",
      "revId": "14da299e4f0af1ad81241890ae132bb4e4ad4127",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8e23439c_bfa4db48",
        "filename": "db/mathlatexml.mysql.sql",
        "patchSetId": 18
      },
      "lineNbr": 25,
      "author": {
        "id": 915
      },
      "writtenOn": "2014-05-08T06:31:49Z",
      "side": 1,
      "message": "Yes, SYSTEM is default unless time zone tables are loaded.\n\nTimestamps are stored in UTC but converted to/from the connection time zone on read and write. If server and client connections are all UTC, like in WMF production or (I guess) your development environment, it\u0027s all fine. But for downstream users with shared servers or connection pools it may not be so predictable.\n\nAs for having a debugging field: They should not be present on a production schema. Simple rule :-) Put such metadata elsewhere. Eg, you could use a trigger on mathlatexml in your development DB for the same tracking effect.",
      "parentUuid": "8e23439c_fbaeee29",
      "revId": "14da299e4f0af1ad81241890ae132bb4e4ad4127",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8e23439c_8a48bb67",
        "filename": "db/mathlatexml.mysql.sql",
        "patchSetId": 18
      },
      "lineNbr": 25,
      "author": {
        "id": 183
      },
      "writtenOn": "2014-05-08T10:34:01Z",
      "side": 1,
      "message": "OK. That\u0027s a good rule. This means I should put the other debug fields i.e. math_status, valid_xml and math_log to a seperate schema as well.\nThe point is that those data is useless during development time. It\u0027s only interesting to track down problems in a production environment.\nI had a conversation with Aaron Schulz. If I got him right currently the math table is constantly growing and there is no way to prune old entries from the table. Effectively this database table is a cache to save the time for re-rendering the equations. I have the feeling that such caches should have some kind of timestamp information. I see that \ntimestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\nis a very MySQL specific solution. In addition it is not optimal and could be tuned by using a course grained time scale like For example timestamp(60). However, I do not want to reinvent the wheel and wonder if there is a mechanism used by other caching tables that I could use here.\nLast remark. This table won\u0027t be created at WMF since the mode MW_MATH_LATEXML is not enabled and will not be enabled, but\nthe mathoid table will have almost the same schema and translations to all SQL-dialects. So this discussion is important never the less.",
      "parentUuid": "8e23439c_bfa4db48",
      "revId": "14da299e4f0af1ad81241890ae132bb4e4ad4127",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    }
  ]
}